{% extends "layouts/base-app.html" %}

{% block title %} Transactions {% endblock %}


{% block content %}

<!-- Jinja2를 이용하여 javascript에 데이터 전달 위한 브릿지 -->
<script type="text/javascript">
    let product_data = {{ product_items | tojson }};

</script>

<div class="container-fluid">
    <h4 class="modal-title">매출전표</h4>
    <form id="sales-form" action="{{ url_for('home_blueprint.transaction_sales') }}" method="post">
        <div class="row">
            <div class="col-auto">
                <div class="input-group">
                    <div class="input-group-text">거래일자</div>
                    <input class="form-control" id="sales-date" name="sales-date" required type="date">
                </div>
            </div>
            <div class="col-auto">
                <div class="input-group">
                    <div class="input-group-text">거래처</div>
                    <select class="form-control" id="sales-partner" name="sales-partner">
                        <option value="none">선택하세요</option>
                        {% for item in partner_items %}
                        <option value="{{ item[0] }}">{{ item[0] }} | {{ item[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="col-auto">
                <div class="input-group">
                    <div class="input-group-text">프로젝트</div>
                    <select class="form-control" id="sales-project" name="sales-project">
                        <option value="none">선택하세요</option>
                        {% for item in project_items %}
                        <option value="{{ item[0] }}">{{ item[0] }} | {{ item[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <hr>

            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-text">적요</div>
                    <input class="form-control" id="sales-description" name="sales-description"
                           placeholder="적요를 입력하세요" type="text">
                </div>
            </div>

            <hr>

            <div class="form-group">
                <div class="form-check form-check-inline">
                    <div class="input-group-text" id="sales-radio">결재유형</div>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio1"
                           name="sale-inlineRadioOptions" type="radio"
                           value="AR" checked>
                    <label class="form-check-label" for="sale-inlineRadio1">외상거래</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio2"
                           name="sale-inlineRadioOptions" type="radio"
                           value="BT">
                    <label class="form-check-label" for="sale-inlineRadio2">계좌이체</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio3"
                           name="sale-inlineRadioOptions" type="radio"
                           value="CC">
                    <label class="form-check-label" for="sale-inlineRadio3">신용카드</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio4"
                           name="sale-inlineRadioOptions" type="radio"
                           value="CA">
                    <label class="form-check-label" for="sale-inlineRadio4">현금</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio5"
                           name="sale-inlineRadioOptions" type="radio"
                           value="GC">
                    <label class="form-check-label" for="sale-inlineRadio5">상품권</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" id="sale-inlineRadio6"
                           name="sale-inlineRadioOptions" type="radio"
                           value="EM">
                    <label class="form-check-label" for="sale-inlineRadio6">E-머니</label>
                </div>
            </div>

            <hr>

            <div class="input-group-text" id="sales-input">매출내역</div>
            <div class="form-group position-relative float-end">
                <button class="badge bg-success" id="button-add-row" type="button">품목추가</button>
                <button class="badge bg-danger" id="button-delete-row" type="button">품목삭제</button>
            </div>

            <div class="form-group">
                <table class="table table-hover" id="sales-table">
                    <thead class="table-dark">
                    <tr>
                        <th scope="col">품목명</th>
                        <th scope="col">과/면</th>
                        <th scope="col">단가</th>
                        <th scope="col">수량</th>
                        <th scope="col">공급가</th>
                        <th scope="col">부가세</th>
                        <th scope="col">결재금액</th>
                    </tr>
                    </thead>
                    <tbody id="sales-table-body">
                    <tr id="sales-table-row">
                        <th id="sales-product-th" scope="row">
                            <select class="form-control" id="sales-product" name="sales-product"
                                    onchange="selectedProductDetail(this)" required>
                                <option value="none">선택하세요</option>
                                {% for item in product_items %}
                                <option value="{{ item[0] }}">{{ item[1] }}</option>
                                {% endfor %}
                            </select>
                        </th>
                        <td id="sales-tax" name="sales-tax"></td>  <!-- custom.js에서 자동 입력 -->
                        <td id="sales-cost" name="sales-cost"></td> <!-- custom.js에서 자동 입력 -->
                        <td id="sales-quantity-td">
                            <input class="form-control _quantity" id="sales-quantity" name="sales-quantity"
                                   onchange="salesAmountCalculation(this)" required type="number">
                        </td>
                        <td id="sales-td-amount"></td> <!-- custom.js에서 자동 입력 -->
                        <!-- form data로 반환하기 위해 hidden input 이용 -->
                        <input class="form-control" id="sales-input-amount" name="sales-amount" type=hidden>
                        <td id="sales-vat-td-amount"></td> <!-- custom.js에서 자동 입력 -->
                        <input class="form-control" id="sales-vat-input-amount" name="sales-vat-amount"
                               type=hidden>
                        <td class="sales-item-sum" id="sales-item-sum" name="sales-item-sum"></td>
                        <!-- custom.js에서 자동 입력 -->
                    </tr>
                    </tbody>
                    <tfoot id="sales-table-foot">
                    <tr>
                        <th class="table-active" colspan="3" scope="row">합계</th>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td id="sales-sum-total"></td>
                    </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <input class="btn btn-secondary" onclick="salesFormReset" type="reset" value="취소">
        <input class="btn btn-primary" type="submit" value="저장">
    </form>
</div>


{% endblock content %}